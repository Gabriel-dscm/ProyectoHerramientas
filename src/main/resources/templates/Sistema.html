<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Billetera Digital</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background-color: #fff; color: #000; }
        .sidebar {
          position: fixed; top: 0; left: 0; height: 100vh; width: 240px;
          background-color: #000; color: #fff; padding-top: 1rem;
        }
        .sidebar .nav-link { color: #bbb; }
        .sidebar .nav-link.active, .sidebar .nav-link:hover {
          background-color: #111; color: #fff; border-radius: 8px;
        }
        .content { margin-left: 250px; padding: 20px; }
        .saldo-card { background: #000; color: #fff; border-radius: 20px; }
        .saldo-card h2 { font-size: 2.2rem; font-weight: bold; }
        .seccion { display: none; }
        .seccion.active { display: block; }
    </style>
</head>
<body>
<div class="sidebar d-flex flex-column p-3">
    <h4 class="mb-4"><i class="bi bi-wallet2 me-2"></i>Billetera</h4>
    <ul class="nav flex-column gap-2">
        <li><a href="#" class="nav-link active" onclick="mostrarSeccion('inicio', event)"><i class="bi bi-house-door me-2"></i> Inicio</a></li>
        <li><a href="#" class="nav-link" onclick="mostrarSeccion('movimientos', event)"><i class="bi bi-graph-up me-2"></i> Movimientos</a></li>
        <li><a href="#" class="nav-link" onclick="mostrarSeccion('perfil', event)"><i class="bi bi-person-circle me-2"></i> Perfil</a></li>
        <li><a href="#" class="nav-link" onclick="mostrarSeccion('transferir', event)"><i class="bi bi-send me-2"></i> Transferir</a></li>
        <li><a href="#" class="nav-link" onclick="mostrarSeccion('configuracion', event)"><i class="bi bi-gear me-2"></i> Configuración</a></li>
    </ul>
</div>

<div class="content">
    <div class="container-fluid">

        <!-- INICIO -->
        <div id="inicio" class="seccion active">
            <div class="card saldo-card p-4 shadow-lg mb-4">
                <p class="mb-1">Saldo Billetera</p>
                <h2 id="saldoBilletera">S/ 0.00</h2>
                <p class="mb-1 mt-3">Saldo Tarjeta</p>
                <h2 id="saldoTarjeta">S/ 0.00</h2>
            </div>
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">Últimos Movimientos</h5>
                            <table class="table table-striped">
                                <thead>
                                <tr><th>Fecha</th><th>Descripción</th><th>Monto</th></tr>
                                </thead>
                                <tbody id="tablaUltimosMov"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title">Distribución de Gastos</h5>
                            <canvas id="gastosChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PERFIL -->
        <div id="perfil" class="seccion">
            <h2><i class="bi bi-person-circle me-2"></i>Perfil</h2>
            <div class="card p-4 shadow-sm mb-4">
                <div class="text-center mb-3">
                    <img src="https://via.placeholder.com/100" class="rounded-circle mb-2" alt="Foto perfil">
                    <div><button class="btn btn-outline-dark btn-sm">Cambiar foto</button></div>
                </div>
                <p><strong>Nombre:</strong> Juan Pérez</p>
                <p><strong>Email:</strong> juanperez@email.com</p>
                <p><strong>Teléfono:</strong> +51 987654321</p>
                <p><strong>Dirección:</strong> Lima, Perú</p>
                <button class="btn btn-dark mb-3">Editar perfil</button>
            </div>

            <div class="card p-4 shadow-sm mb-4">
                <h5>💳 Vincular Tarjeta</h5>
                <form onsubmit="vincularTarjeta(event)">
                    <input type="text" id="numeroTarjeta" class="form-control mb-2" placeholder="Número de tarjeta" required>
                    <input type="number" id="saldoInicialTarjeta" class="form-control mb-2" placeholder="Saldo inicial" required>
                    <button class="btn btn-success">Vincular</button>
                </form>
                <p id="tarjetaVinculada" class="mt-2"></p>
            </div>
        </div>

        <!-- MOVIMIENTOS -->
        <div id="movimientos" class="seccion">
            <h2><i class="bi bi-graph-up me-2"></i> Movimientos</h2>
            <form class="row g-3 mb-3" onsubmit="agregarMovimiento(event)">
                <div class="col-md-5">
                    <input type="text" id="descMovimiento" class="form-control" placeholder="Descripción" required>
                </div>
                <div class="col-md-4">
                    <input type="number" id="montoMovimiento" class="form-control" placeholder="Monto" required>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-dark w-100">Agregar</button>
                </div>
            </form>
            <ul id="listaMovimientos" class="list-group mb-4"></ul>
        </div>


        <!-- TRANSFERIR -->
        <div id="transferir" class="seccion">
            <h2><i class="bi bi-send me-2"></i>Transferir</h2>
            <form onsubmit="transferirDinero(event)">
                <div class="row mb-3">
                    <div class="col-md-5">
                        <select id="origen" class="form-control" required>
                            <option value="billetera">Billetera</option>
                            <option value="tarjeta">Tarjeta</option>
                        </select>
                    </div>
                    <div class="col-md-5">
                        <select id="destino" class="form-control" required>
                            <option value="tarjeta">Tarjeta</option>
                            <option value="billetera">Billetera</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="montoTransferencia" class="form-control" placeholder="S/ 0.00" required>
                    </div>
                </div>
                <button class="btn btn-warning">Confirmar</button>
            </form>
        </div>

        <!-- CONFIGURACIÓN -->
        <div id="configuracion" class="seccion">
            <h2><i class="bi bi-gear me-2"></i>Configuración</h2>
            <div class="card p-4 shadow-sm mb-3">
                <h5>Tema</h5>
                <button class="btn btn-outline-dark" onclick="cambiarTema()">Cambiar a oscuro/claro</button>
            </div>
            <div class="card p-4 shadow-sm mb-3">
                <h5>Notificaciones</h5>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" id="notificaciones">
                    <label class="form-check-label" for="notificaciones">Activar notificaciones</label>
                </div>
            </div>
            <div class="card p-4 shadow-sm mb-3">
                <h5>Idioma</h5>
                <select class="form-select">
                    <option>Español</option>
                    <option>Inglés</option>
                </select>
            </div>
            <div class="card p-4 shadow-sm">
                <button class="btn btn-danger">Eliminar cuenta</button>
            </div>
        </div>

    </div>
</div>

<script>
    let saldoBilletera = 0;
    let saldoTarjeta = 0;
    let movimientos = [];

    const ctx = document.getElementById('gastosChart').getContext('2d');
    const gastosChart = new Chart(ctx, {
      type: 'pie',
      data: { labels: [], datasets: [{ data: [], backgroundColor: [] }] }
    });

    function mostrarSeccion(id, event) {
      document.querySelectorAll('.seccion').forEach(div => div.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('.sidebar .nav-link').forEach(link => link.classList.remove('active'));
      event.target.classList.add('active');
    }

    function actualizarSaldos() {
      document.getElementById("saldoBilletera").textContent = "S/ " + saldoBilletera.toFixed(2);
      document.getElementById("saldoTarjeta").textContent = "S/ " + saldoTarjeta.toFixed(2);
    }

    function vincularTarjeta(e) {
      e.preventDefault();
      const numero = document.getElementById("numeroTarjeta").value;
      const saldoInicial = parseFloat(document.getElementById("saldoInicialTarjeta").value);
      saldoTarjeta = saldoInicial;
      actualizarSaldos();
      document.getElementById("tarjetaVinculada").textContent = `Tarjeta vinculada: **** **** **** ${numero.slice(-4)}`;
      e.target.reset();
    }

    function transferirDinero(e) {
      e.preventDefault();
      const origen = document.getElementById("origen").value;
      const destino = document.getElementById("destino").value;
      const monto = parseFloat(document.getElementById("montoTransferencia").value);

      if (origen === destino) {
        alert("El origen y destino no pueden ser iguales.");
        return;
      }
      if (origen === "billetera" && monto > saldoBilletera) {
        alert("Saldo insuficiente en billetera.");
        return;
      }
      if (origen === "tarjeta" && monto > saldoTarjeta) {
        alert("Saldo insuficiente en tarjeta.");
        return;
      }

      if (origen === "billetera") {
        saldoBilletera -= monto;
        saldoTarjeta += monto;
        agregarMovimientoAutomatico("Transferencia a tarjeta", -monto);
      } else {
        saldoTarjeta -= monto;
        saldoBilletera += monto;
        agregarMovimientoAutomatico("Transferencia a billetera", -monto);
      }
      actualizarSaldos();
      e.target.reset();
      alert("Transferencia realizada con éxito.");
    }

    function agregarMovimiento(e) {
      e.preventDefault();
      const desc = document.getElementById("descMovimiento").value;
      const monto = parseFloat(document.getElementById("montoMovimiento").value);
      const fecha = new Date().toLocaleDateString();

      movimientos.push({ fecha, desc, monto });

      const li = document.createElement("li");
      li.className = "list-group-item d-flex justify-content-between align-items-center";
      li.innerHTML = `${desc}: S/ ${monto.toFixed(2)}
        <button class="btn btn-danger btn-sm" onclick="this.parentElement.remove()">Eliminar</button>`;
      document.getElementById("listaMovimientos").appendChild(li);

      const fila = `<tr>
        <td>${fecha}</td>
        <td>${desc}</td>
        <td class="${monto < 0 ? 'text-danger' : 'text-success'}">
          ${monto < 0 ? '-' : '+'} S/ ${Math.abs(monto).toFixed(2)}
        </td>
      </tr>`;
      document.getElementById("tablaUltimosMov").insertAdjacentHTML("afterbegin", fila);

      actualizarGrafico();

      document.getElementById("descMovimiento").value = "";
      document.getElementById("montoMovimiento").value = "";
    }

    function agregarMovimientoAutomatico(desc, monto) {
      const fecha = new Date().toLocaleDateString();
      movimientos.push({ fecha, desc, monto });

      const fila = `<tr>
        <td>${fecha}</td>
        <td>${desc}</td>
        <td class="${monto < 0 ? 'text-danger' : 'text-success'}">
          ${monto < 0 ? '-' : '+'} S/ ${Math.abs(monto).toFixed(2)}
        </td>
      </tr>`;
      document.getElementById("tablaUltimosMov").insertAdjacentHTML("afterbegin", fila);

      actualizarGrafico();
    }

    function actualizarGrafico() {
      const categorias = {};
      movimientos.forEach(mov => {
        if (!categorias[mov.desc]) categorias[mov.desc] = 0;
        categorias[mov.desc] += Math.abs(mov.monto);
      });

      gastosChart.data.labels = Object.keys(categorias);
      gastosChart.data.datasets[0].data = Object.values(categorias);
      gastosChart.data.datasets[0].backgroundColor = Object.keys(categorias).map(() =>
        `hsl(${Math.random() * 360}, 70%, 60%)`
      );
      gastosChart.update();
    }

    function cambiarTema() {
      document.body.classList.toggle("bg-dark");
      document.body.classList.toggle("text-white");
    }

    actualizarSaldos();
</script>

</body>
</html>
